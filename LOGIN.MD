# 登录功能扩展路线图（Rust Web 后台）

## 1. 基础密码校验 + 返回 JWT

-   用户提交 username/password\
-   校验密码（bcrypt / argon2）\
-   生成 JWT（含用户 id, role）\
-   返回 token

------------------------------------------------------------------------

## 2. 登录失败次数限制（防止暴力破解）

-   记录同一 IP 或同一账号的失败次数\
-   超过 N 次 → 限制登录一段时间\
-   可使用 Redis / 数据库存储

------------------------------------------------------------------------

## 3. 登录日志（审计）

-   登录成功/失败写入 login_log 表
    -   user_id\
    -   ip\
    -   ua\
    -   login_time\
    -   success/fail

------------------------------------------------------------------------

## 4. 登录验证码（图形验证码或滑块）

-   登录失败超过阈值后触发\
-   可用 captcha-rs 或第三方滑块验证码

------------------------------------------------------------------------

## 5. JWT 刷新机制（Refresh Token）

-   Access Token: 15min\
-   Refresh Token: 7--30 天\
-   使用 refresh_token 换新 access_token\
-   refresh_token 可存数据库以实现"踢人下线"

------------------------------------------------------------------------

## 6. 单设备登录 / 限制多设备登录

-   保存当前最新 JWT 的 jti\
-   旧 token 全部失效\
-   或限制同一账号最多 N 个会话

------------------------------------------------------------------------

## 7. 账号状态控制（锁定/禁用/冻结）

数据库字段示例：

``` sql
status TINYINT DEFAULT 1  -- 1正常, 0禁用, 2冻结
```

登录校验前检查用户状态。

------------------------------------------------------------------------

## 8. 二步验证（2FA）

-   支持 TOTP（Google Authenticator）\
-   或短信/邮箱验证码
